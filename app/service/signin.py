from app.classes.sql import Mysql
from app.classes.logging import Logging

class Signin(Logging):

    def __init__(self):

        Logging.__init__(self)
        self.__mysql = Mysql()

    def signin(self, form):

        user_name = form.get('user_name')
        user_pwd = form.get('user_pwd')

        sql = f"Select * from user where user_name = '{user_name}' and user_pwd = '{user_pwd}'"

        print(sql)

        try:
            verify = self.__mysql.search(sql = sql)

        except:

            raise Exception

        finally:
            self.__mysql.close()


        if len(verify) != 0:
            self.__user_data = {"user_id" : verify[0][0],
                         "user_name" : verify[0][1]
                        }

            return True

        else:
            return False

    @property
    def user_data(self):

        return self.__user_data

'''
Dangerous SQL: 
user_pwd = 123' or '1'='1
user_name = SQLInjection' or 1=1 -- 
'''