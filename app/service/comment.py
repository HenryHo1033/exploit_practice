from app.classes.sql import Mysql
import pymysql

class Comment(Mysql):
    __COMMENT = "comment"

    def __init__(self):

        super().__init__()

    def user_comment(self):

        sql = f"Select * from {Comment.__COMMENT}"

        try:
            self.__comment = self.search(sql)

        except:

            raise Exception

        finally:

            self.close()

    @property
    def comment(self):
        comment_list = []

        for comment in self.__comment:
            comment_list.append({
            "comment_id" : comment[0],
            "user_id" : comment[1],
            "comment_cotent" : comment[2],
            "created_time" : comment[3]
    })

        return comment_list

    def post_comment(self, form):

        user_id = form.get('user_id')
        comment = form.get('comment')

        sql = f'INSERT INTO comment (user_id, content) VALUES ({user_id},"{comment}");'
        print (sql)

        self.insert(sql)

