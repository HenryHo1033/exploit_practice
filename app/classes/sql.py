import pymysql
from app.classes.conf_loader import ConfLoader

class Mysql():

    def __init__(self):

        self.__conf_loader = ConfLoader()
        self.__db = pymysql.connect(host = self.__conf_loader.conf_info('db_conf','host'),
                                    port = self.__conf_loader.conf_info('db_conf','port'),
                                    user = self.__conf_loader.conf_info('db_user','name'),
                                    password = self.__conf_loader.conf_info('db_user','passwd'),
                                    database = self.__conf_loader.conf_info('db_conf','practice')
                                    )

    def set_cursor(self):

        self.__cursor = self.__db.cursor()

    @property
    def cursor(self):

        return self.__cursor

    def sql_excutor(self, sql):
        try:
            self.__cursor.execute(sql)

        except:
            raise Exception

        finally:

            self.__cursor.close()