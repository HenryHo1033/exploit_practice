import os
import smtplib
from app.classes.conf_loader import ConfLoader
from email.mime.multipart import MIMEMultipart
from email.mime.image import MIMEImage
from email.mime.text import MIMEText
from email.header import Header

class Common():
    @classmethod
    def work_dir(self):

        work_dir = os.path.dirname(os.path.abspath(__file__))
        front_dir = os.path.dirname(work_dir)

        return front_dir

class SMTP():

    SMTP_SERVER = ConfLoader().conf_info("db_conf","server")
    SMTP_PORT = ConfLoader().conf_info("db_conf","port")
    SMTP_ACCOUNT = ConfLoader().conf_info("db_conf","account")
    SMTP_PASSWORD = ConfLoader().conf_info("db_conf","password")
    SMTP_CLIENT = ConfLoader().conf_info("db_conf","client_email")

    def __init__(self):

        self.smtp = smtplib.SMTP_SSL(SMTP.SMTP_SERVER, SMTP.SMTP_PORT)


    def msg_context(self, subject, body):

        msg = MIMEMultipart()
        msg["From"] = Header(SMTP.SMTP_ACCOUNT)
        msg["To"] = Header(SMTP.SMTP_ACCOUNT)
        msg["Subject"] = Header(subject)
        msg.attach(MIMEText(body, 'html'))

        return msg